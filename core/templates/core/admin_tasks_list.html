{% extends "core/base.html" %}
{% block content %}
<h2 class="mb-3">Admin Tasks</h2>

<form method="get" class="row g-2 mb-3">
  <div class="col-auto">
    <select name="f" class="form-select">
      <option value="upcoming" {% if f == "upcoming" %}selected{% endif %}>Upcoming</option>
      <option value="past" {% if f == "past" %}selected{% endif %}>Past</option>
    </select>
  </div>
  <div class="col-auto">
    <input type="text" name="q" value="{{ q }}" class="form-control" placeholder="Search title/notes">
  </div>
  <div class="col-auto">
    <button class="btn btn-primary">Apply</button>
    <a class="btn btn-outline-secondary" href="{% url 'admin_tasks_list' %}">Reset</a>
  </div>
  <div class="col-auto ms-auto">
    <a class="btn btn-success" href="{% url 'admin_task_create' %}">New Task</a>
  </div>
</form>

{% if messages %}
  {% for m in messages %}<div class="alert alert-info py-1">{{ m }}</div>{% endfor %}
{% endif %}

<div class="table-responsive">
<table class="table table-hover align-middle">
  <thead>
    <tr>
      <th>Due</th>
      <th>Title</th>
      <th>Notes</th>
      <th class="text-end">Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for r in rows %}
      <tr>
        <td>{{ r.due_dt|date:"Y-m-d H:i" }}</td>
        <td>{{ r.title }}</td>
        <td class="small">{{ r.notes|default:"â€”" }}</td>
        <td class="text-end">
          <a class="btn btn-sm btn-outline-primary" href="{% url 'admin_task_edit' r.id %}">Edit</a>
          <a class="btn btn-sm btn-outline-danger" href="{% url 'admin_task_delete' r.id %}">Delete</a>
        </td>
      </tr>
    {% empty %}
      <tr><td colspan="4" class="text-muted">No tasks found.</td></tr>
    {% endfor %}
  </tbody>
</table>
</div>
{% endblock %}